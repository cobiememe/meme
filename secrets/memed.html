<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Cobie — Crypto Sentiment Social (MVP Layout)</title>

<!-- ✅ Phantom Wallet -->
<script src="https://unpkg.com/@solana/web3.js@latest/lib/index.iife.js"></script>

<style>
  :root{
    --bg:#0b0f14; --bg2:#0a0f16; --panel:#0f1622; --ink:#e9fbff; --muted:#9ed9e6;
    --line:#173048; --accent:#00eaff; --accent2:#00bfff; --good:#14F195; --bad:#ff6b6b;
  }
  *{box-sizing:border-box}
  html,body{height:100%;margin:0;background:radial-gradient(1200px 800px at 70% -10%,rgba(0,234,255,.08),transparent 60%),linear-gradient(180deg,#05080c,#0a0f16 40%,#05080c);
    color:var(--ink);font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial}
  .container{max-width:1200px;margin:0 auto;padding:16px 16px 80px 16px}
  header{position:sticky;top:0;z-index:10;backdrop-filter:saturate(140%) blur(6px);
    background:linear-gradient(180deg,rgba(10,15,22,.9),rgba(10,15,22,.5));border-bottom:1px solid rgba(255,255,255,.06)}
  .h-wrap{max-width:1200px;margin:0 auto;padding:12px 16px;display:flex;align-items:center;gap:12px}

  .brand-wrap { display:flex; align-items:center; gap:10px; }
  .brand-logo {
    width:38px; height:38px; border-radius:8px; object-fit:cover;
    border:2px solid rgba(0,234,255,0.5); box-shadow:0 0 12px rgba(0,234,255,0.4);
  }
  .brand { display:flex; align-items:baseline; gap:4px; font-weight:800; }
  .brand-main {
    font-size:20px;
    background:linear-gradient(90deg,#00eaff,#14f195,#00ffa3);
    -webkit-background-clip:text; -webkit-text-fill-color:transparent;
    animation:brandPulse 2.2s infinite ease-in-out;
  }
  @keyframes brandPulse{
    0%{text-shadow:0 0 2px rgba(0,234,255,.7),0 0 6px rgba(0,191,255,.4)}
    50%{text-shadow:0 0 6px rgba(0,234,255,1),0 0 16px rgba(20,241,149,.7)}
    100%{text-shadow:0 0 2px rgba(0,234,255,.7),0 0 6px rgba(0,191,255,.4)}
  }

  .status{font-size:12px;color:var(--muted);padding:6px 10px;border:1px solid rgba(255,255,255,.08);border-radius:999px}
  .btn{background:linear-gradient(135deg,rgba(0,234,255,.2),rgba(0,191,255,.15));
    border:1px solid rgba(255,255,255,.12);padding:10px 14px;border-radius:12px;font-weight:700;cursor:pointer}
  .grid{display:grid;grid-template-columns:1.2fr .8fr;gap:16px;margin-top:16px}
  @media (max-width:980px){.grid{grid-template-columns:1fr}}
  .card{background:rgba(17,24,39,.6);border:1px solid rgba(255,255,255,.08);border-radius:16px}
  .card .body{padding:14px}
  .post{padding:14px;display:grid;grid-template-columns:42px 1fr;gap:12px}
  .avatar{width:42px;height:42px;border-radius:12px;background:conic-gradient(from 120deg,#9945FF,#14F195,#00FFA3,#9945FF)}
</style>
</head>

<body>
<header>
  <div class="h-wrap">

    <div class="brand-wrap">
      <img src="../img/1boss.png" class="brand-logo">
      <div class="brand">
        <span class="brand-main">Cobie</span>
        <span style="font-size:14px;color:#9ed9e6">Sentiment Social</span>
        <span style="font-size:12px;color:rgba(255,255,255,.55)">— MVP</span>
      </div>
    </div>

    <span id="wallet-status" class="status">Nicht verbunden</span>
    <div style="flex:1"></div>
    <button id="connectBtn" class="btn">Wallet verbinden</button>
  </div>
</header>

<main class="container">
  <div class="grid">
    <section>
      <div class="card">
        <div class="body">
          <h3>Post verfassen</h3>
          <textarea id="postText" maxlength="140" style="width:100%;height:90px"></textarea>
          <span style="font-size:12px">Gebühr: 0.001 SOL</span>
          <button id="postBtn" class="btn">Posten</button>
        </div>
      </div>

      <div class="card" style="margin-top:12px">
        <div class="body">
          <h3>Community Feed</h3>
        </div>
        <div id="feed"></div>
      </div>
    </section>

    <aside>
      <div class="card"><div class="body"><h3>Sentiment & Trends</h3></div></div>
    </aside>
  </div>
</main>

<script>
/* DOM */
const walletStatus = document.getElementById("wallet-status");
const connectBtn = document.getElementById("connectBtn");
const postBtn = document.getElementById("postBtn");
const feed = document.getElementById("feed");
let walletConnected = false;
let provider = null;
let publicKey = null;

/* ✅ Phantom provider */
function getProvider() {
  if ("solana" in window && window.solana.isPhantom) return window.solana;
  alert("Install Phantom Wallet");
  window.open("https://phantom.app", "_blank");
}

/* ✅ Connect */
async function connectWallet(){
  try {
    provider = getProvider();
    const resp = await provider.connect();
    publicKey = resp.publicKey.toString();
    walletConnected = true;
    walletStatus.textContent = "✅ " + publicKey.slice(0,4) + "..." + publicKey.slice(-4);
    connectBtn.textContent = "Disconnect";
  } catch(e){}
}

/* ✅ Disconnect */
async function disconnectWallet(){
  try { await provider.disconnect(); }catch{}
  walletConnected = false;
  publicKey = null;
  walletStatus.textContent = "Nicht verbunden";
  connectBtn.textContent = "Wallet verbinden";
}

connectBtn.onclick = ()=> walletConnected ? disconnectWallet() : connectWallet();

/* ✅ SOL Transaction */
async function sendPostFee() {
  const connection = new solanaWeb3.Connection("https://api.mainnet-beta.solana.com", "confirmed");
  const fromPubkey = new solanaWeb3.PublicKey(publicKey);

  // <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
  // ✅ REPLACE THIS WITH YOUR WALLET ADDRESS
  const toPubkey = new solanaWeb3.PublicKey("YOUR_SOL_WALLET_ADDRESS_HERE");
  // <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<

  const tx = new solanaWeb3.Transaction().add(
    solanaWeb3.SystemProgram.transfer({
      fromPubkey,
      toPubkey,
      lamports: 0.001 * solanaWeb3.LAMPORTS_PER_SOL
    })
  );

  tx.feePayer = fromPubkey;
  tx.recentBlockhash = (await connection.getLatestBlockhash()).blockhash;

  const signed = await provider.signTransaction(tx);
  const sig = await connection.sendRawTransaction(signed.serialize());
  await connection.confirmTransaction(sig, "confirmed");

  return sig;
}

/* ✅ Add Post */
function addPost(text){
  feed.innerHTML =
    `<div class="post">
      <div class="avatar"></div>
      <div><b>${publicKey.slice(0,6)}...</b><p>${text}</p></div>
    </div>` + feed.innerHTML;
}

/* ✅ Post button logic */
postBtn.onclick = async ()=>{
  const text = document.getElementById("postText").value.trim();
  if (!walletConnected) return alert("Bitte Wallet verbinden");
  if (!text) return alert("Bitte Text eingeben");

  postBtn.disabled = true;
  postBtn.textContent = "Sende 0.001 SOL...";

  try {
    const sig = await sendPostFee();
    addPost(text);
    alert("✅ Zahlung erfolgreich\nTX: " + sig);
  } catch {
    alert("❌ Zahlung abgebrochen");
  }

  postBtn.disabled = false;
  postBtn.textContent = "Posten";
  document.getElementById("postText").value = "";
};
</script>
</body>
</html>
