<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WhaleTracker Pro - Real Hyperliquid Data</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        .animate-fade-in { animation: fadeIn 0.5s ease-out; }
        .animate-spin { animation: spin 1s linear infinite; }
        .glass-card { 
            background: rgba(15, 23, 42, 0.7); 
            border: 1px solid rgba(124, 58, 237, 0.1); 
            backdrop-filter: blur(10px);
        }
        .tab-active { 
            border-bottom: 2px solid #8b5cf6;
            color: #8b5cf6;
        }
        tr:hover { 
            background-color: rgba(139, 92, 246, 0.1) !important; 
            transform: scale(1.01);
            transition: all 0.15s ease;
        }
        .tab-content {
            transition: opacity 0.3s ease;
        }
        .tab-content.hidden { 
            opacity: 0; 
            pointer-events: none;
            position: absolute;
        }
        .tab-content:not(.hidden) {
            opacity: 1;
            position: relative;
        }
        .pulse-ring {
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0% { transform: scale(0.95); opacity: 1; }
            50% { transform: scale(1); opacity: 0.7; }
            100% { transform: scale(0.95); opacity: 1; }
        }
        .badge-buy { background: #10b981; color: white; }
        .badge-sell { background: #ef4444; color: white; }
        .badge-whale { background: #8b5cf6; color: white; }
    </style>
</head>
<body class="bg-gradient-to-br from-slate-900 via-indigo-950 to-slate-900 text-white min-h-screen">
    <div id="app" class="p-4">
        <!-- Header -->
        <header class="max-w-7xl mx-auto mb-8">
            <div class="flex items-center justify-between">
                <div class="flex items-center gap-3">
                    <div class="relative">
                        <div class="w-12 h-12 bg-gradient-to-r from-purple-500 to-blue-500 rounded-xl flex items-center justify-center text-white font-bold text-lg pulse-ring">
                            üêã
                        </div>
                        <div class="absolute -top-1 -right-1 w-4 h-4 bg-green-400 rounded-full border-2 border-slate-900"></div>
                    </div>
                    <div>
                        <h1 class="text-3xl font-bold bg-gradient-to-r from-purple-400 to-blue-400 bg-clip-text text-transparent">
                            WhaleTracker Pro
                        </h1>
                        <p class="text-gray-400 mt-1">üî¥ LIVE Hyperliquid whale tracking</p>
                    </div>
                </div>
                <div class="flex items-center gap-4">
                    <button class="px-4 py-2 bg-purple-600 hover:bg-purple-700 rounded-lg transition flex items-center gap-2">
                        <i class="fas fa-bolt"></i>
                        <span>Live</span>
                        <div class="w-2 h-2 bg-green-400 rounded-full animate-pulse"></div>
                    </button>
                </div>
            </div>
        </header>

        <div class="max-w-7xl mx-auto flex gap-6">
            <!-- Main Content -->
            <div class="flex-1">
                <!-- Tabs Navigation -->
                <div class="mb-6">
                    <div class="flex border-b border-slate-700 gap-6 overflow-x-auto">
                        <button class="tab-btn py-3 px-1 font-medium text-gray-400 hover:text-white transition tab-active" data-tab="trades">
                            <i class="fas fa-bolt mr-2"></i>Whale Trades
                        </button>
                        <button class="tab-btn py-3 px-1 font-medium text-gray-400 hover:text-white transition" data-tab="wallets">
                            <i class="fas fa-fish mr-2"></i>Watched Wallets
                        </button>
                    </div>
                </div>

                <!-- API Status -->
                <div id="api-status" class="mb-6">
                    <div class="bg-yellow-900/20 border border-yellow-500/30 rounded-lg p-3">
                        <p class="text-yellow-400 text-sm flex items-center">
                            <i class="fas fa-info-circle mr-2"></i>
                            <span id="status-message">üêã Ready to scan Hyperliquid!</span>
                        </p>
                    </div>
                </div>

                <!-- Control Panel -->
                <div class="glass-card rounded-xl p-6 mb-6">
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                        <div>
                            <label class="block text-sm font-medium mb-2 text-gray-300">
                                <i class="fas fa-filter mr-2"></i>Min Trade Size
                            </label>
                            <select id="min-amount" class="w-full bg-slate-800 border border-slate-700 rounded-lg px-3 py-2 text-white text-sm">
                                <option value="10000">$10K+</option>
                                <option value="50000">$50K+</option>
                                <option value="100000" selected>$100K+</option>
                                <option value="500000">$500K+</option>
                                <option value="1000000">$1M+</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2 text-gray-300">
                                <i class="fas fa-coins mr-2"></i>Asset
                            </label>
                            <select id="asset-select" class="w-full bg-slate-800 border border-slate-700 rounded-lg px-3 py-2 text-white text-sm">
                                <option value="all">All Assets</option>
                                <option value="BTC">BTC</option>
                                <option value="ETH">ETH</option>
                                <option value="SOL">SOL</option>
                            </select>
                        </div>
                        <div class="flex items-end gap-2">
                            <button id="btn-scan" class="flex-1 bg-purple-600 hover:bg-purple-700 py-2 px-4 rounded-lg font-medium transition flex items-center justify-center gap-2">
                                <i id="scan-icon" class="fas fa-search"></i>
                                Scan Whales
                            </button>
                            <button id="btn-refresh" class="flex-1 bg-green-600 hover:bg-green-700 py-2 px-4 rounded-lg font-medium transition flex items-center justify-center gap-2">
                                <i id="refresh-icon" class="fas fa-sync"></i>
                                Refresh
                            </button>
                        </div>
                        <div class="flex items-end">
                            <button id="btn-export" class="w-full bg-blue-600 hover:bg-blue-700 py-2 px-4 rounded-lg font-medium transition flex items-center justify-center gap-2">
                                <i class="fas fa-download"></i>
                                Export
                            </button>
                        </div>
                    </div>

                    <!-- Add Custom Wallet -->
                    <div class="mt-6 pt-6 border-t border-slate-700/50">
                        <label class="block text-sm font-medium mb-2 text-gray-300">
                            <i class="fas fa-plus mr-2"></i>Add Whale Wallet to Track
                        </label>
                        <div class="flex gap-2">
                            <input 
                                id="custom-wallet" 
                                type="text" 
                                placeholder="Enter Hyperliquid address (0x...)" 
                                class="flex-1 bg-slate-800 border border-slate-700 rounded-lg px-3 py-2 text-white text-sm placeholder-gray-500 font-mono"
                            >
                            <button id="btn-add-wallet" class="bg-blue-600 hover:bg-blue-700 px-6 py-2 rounded-lg transition flex items-center gap-2">
                                <i class="fas fa-plus"></i>
                                Add
                            </button>
                        </div>
                        <p class="text-xs text-gray-500 mt-2">üí° Tip: Find whale addresses on Hyperliquid leaderboards</p>
                    </div>
                </div>

                <!-- Stats Cards -->
                <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
                    <div class="glass-card rounded-xl p-4 animate-fade-in hover:transform hover:scale-105 transition-all duration-200">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-gray-400 text-sm">Whale Trades</p>
                                <p id="stat-trades" class="text-2xl font-bold text-green-400">0</p>
                            </div>
                            <div class="w-10 h-10 bg-green-500/20 rounded-lg flex items-center justify-center">
                                <i class="fas fa-chart-line text-green-400"></i>
                            </div>
                        </div>
                    </div>
                    <div class="glass-card rounded-xl p-4 animate-fade-in hover:transform hover:scale-105 transition-all duration-200">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-gray-400 text-sm">Tracked Wallets</p>
                                <p id="stat-wallets" class="text-2xl font-bold text-purple-400">0</p>
                            </div>
                            <div class="w-10 h-10 bg-purple-500/20 rounded-lg flex items-center justify-center">
                                <i class="fas fa-fish text-purple-400"></i>
                            </div>
                        </div>
                    </div>
                    <div class="glass-card rounded-xl p-4 animate-fade-in hover:transform hover:scale-105 transition-all duration-200">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-gray-400 text-sm">Total Volume</p>
                                <p id="stat-volume" class="text-2xl font-bold text-blue-400">$0</p>
                            </div>
                            <div class="w-10 h-10 bg-blue-500/20 rounded-lg flex items-center justify-center">
                                <i class="fas fa-dollar-sign text-blue-400"></i>
                            </div>
                        </div>
                    </div>
                    <div class="glass-card rounded-xl p-4 animate-fade-in hover:transform hover:scale-105 transition-all duration-200">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-gray-400 text-sm">Avg Trade Size</p>
                                <p id="stat-avg" class="text-2xl font-bold text-orange-400">$0</p>
                            </div>
                            <div class="w-10 h-10 bg-orange-500/20 rounded-lg flex items-center justify-center">
                                <i class="fas fa-chart-bar text-orange-400"></i>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tab Content -->
                <div class="relative">
                    <!-- Trades Tab -->
                    <div id="trades-tab" class="tab-content">
                        <div class="glass-card rounded-xl border border-green-500/20 overflow-hidden">
                            <div class="p-4 border-b border-slate-700/50 flex items-center justify-between">
                                <h2 class="text-lg font-semibold flex items-center gap-2">
                                    <i class="fas fa-bolt text-green-400"></i>
                                    Live Whale Trades
                                </h2>
                                <div class="flex items-center gap-2">
                                    <div class="text-sm text-gray-400">
                                        <span id="trades-count">0</span> trades
                                    </div>
                                    <div class="w-2 h-2 bg-green-400 rounded-full animate-pulse"></div>
                                </div>
                            </div>
                            <div class="overflow-x-auto">
                                <table class="w-full">
                                    <thead class="bg-slate-800/50">
                                        <tr>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-400 uppercase">Wallet</th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-400 uppercase">Asset</th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-400 uppercase">Side</th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-400 uppercase">Size</th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-400 uppercase">Price</th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-400 uppercase">Value</th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-400 uppercase">Time</th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-400 uppercase">Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="trades-tbody" class="divide-y divide-slate-700/50">
                                        <tr>
                                            <td colspan="8" class="px-4 py-8 text-center text-gray-400">
                                                <i class="fas fa-search mb-2 text-2xl"></i>
                                                <p>Click "Scan Whales" to fetch LIVE data from Hyperliquid! üêã</p>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <!-- Wallets Tab -->
                    <div id="wallets-tab" class="tab-content hidden">
                        <div class="glass-card rounded-xl border border-purple-500/20 overflow-hidden">
                            <div class="p-4 border-b border-slate-700/50">
                                <h2 class="text-lg font-semibold flex items-center gap-2">
                                    <i class="fas fa-eye text-purple-400"></i>
                                    Tracked Whale Wallets
                                </h2>
                                <p class="text-sm text-gray-400 mt-1">Manage wallets you're tracking</p>
                            </div>
                            <div class="p-4">
                                <div id="wallets-list" class="space-y-3">
                                    <p class="text-gray-400 text-center py-8">
                                        <i class="fas fa-fish mb-2 text-2xl block"></i>
                                        No wallets tracked yet. Add some whales to watch!
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Live Activity Feed -->
            <div class="hidden lg:block w-80">
                <div class="sticky top-28 glass-card rounded-xl p-4 border border-slate-700/50">
                    <div class="flex items-center gap-2 mb-4">
                        <i class="fas fa-bolt text-yellow-400"></i>
                        <span class="font-semibold">Live Activity</span>
                        <div class="w-2 h-2 bg-green-400 rounded-full animate-pulse ml-auto"></div>
                    </div>
                    <div id="activity-feed" class="space-y-3 max-h-[600px] overflow-y-auto">
                        <div class="text-sm p-2 rounded-lg bg-slate-800/30 text-center text-gray-400">
                            Waiting for trades...
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // üî• REAL HYPERLIQUID API CONFIGURATION
        const HYPERLIQUID_API = {
            BASE: 'https://api.hyperliquid.xyz',
            INFO: '/info'
        };

        // üêã DEFAULT WHALE WALLETS (Top traders from Hyperliquid leaderboards)
        // Add more addresses from: https://app.hyperliquid.xyz/leaderboard
        const DEFAULT_WHALES = [
            '0x563c175E6F11582f65D6d9E360A618699DEe14a6', // Example whale
            '0x00000000002bde777710C370F2F570a1F2c483Bb', // Example vault
            // Add more real whale addresses here
        ];

        // State Management
        let state = {
            minAmount: 100000,
            activeAsset: 'all',
            trades: [],
            trackedWallets: new Set(JSON.parse(localStorage.getItem('hl_tracked_wallets') || '[]')),
            isScanning: false
        };

        // Add default whales if none tracked
        if (state.trackedWallets.size === 0) {
            DEFAULT_WHALES.forEach(w => state.trackedWallets.add(w));
            localStorage.setItem('hl_tracked_wallets', JSON.stringify([...state.trackedWallets]));
        }

        // Helper Functions
        function formatAmount(amount) {
            if (!amount || isNaN(amount)) return '$0';
            if (amount >= 1000000000) return '$' + (amount / 1000000000).toFixed(2) + 'B';
            if (amount >= 1000000) return '$' + (amount / 1000000).toFixed(2) + 'M';
            if (amount >= 1000) return '$' + (amount / 1000).toFixed(1) + 'K';
            return '$' + amount.toFixed(2);
        }

        function shortenAddress(address) {
            if (!address) return 'N/A';
            return `${address.slice(0, 6)}...${address.slice(-4)}`;
        }

        function formatTime(timestamp) {
            const date = new Date(timestamp);
            const now = new Date();
            const diff = now - date;
            
            const minutes = Math.floor(diff / 60000);
            const hours = Math.floor(minutes / 60);
            const days = Math.floor(hours / 24);
            
            if (minutes < 1) return 'Just now';
            if (minutes < 60) return `${minutes}m ago`;
            if (hours < 24) return `${hours}h ago`;
            return `${days}d ago`;
        }

        function showApiStatus(message, type = 'info') {
            const statusDiv = document.getElementById('api-status');
            const messageEl = document.getElementById('status-message');
            
            statusDiv.className = `mb-6 rounded-lg p-3 border ${
                type === 'error' ? 'bg-red-900/20 border-red-500/30' :
                type === 'success' ? 'bg-green-900/20 border-green-500/30' :
                'bg-yellow-900/20 border-yellow-500/30'
            }`;
            
            messageEl.className = `text-sm flex items-center ${
                type === 'error' ? 'text-red-400' :
                type === 'success' ? 'text-green-400' :
                'text-yellow-400'
            }`;
            
            messageEl.innerHTML = `<i class="fas fa-${type === 'error' ? 'exclamation-triangle' : type === 'success' ? 'check-circle' : 'info-circle'} mr-2"></i>${message}`;
        }

        // üî• FETCH USER FILLS FROM HYPERLIQUID
        async function getUserFills(walletAddress) {
            try {
                const response = await fetch(HYPERLIQUID_API.BASE + HYPERLIQUID_API.INFO, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        type: 'userFills',
                        user: walletAddress
                    })
                });

                if (!response.ok) throw new Error(`HTTP ${response.status}`);
                
                const fills = await response.json();
                return fills || [];
            } catch (error) {
                console.error(`Error fetching fills for ${walletAddress}:`, error);
                return [];
            }
        }

        // üêã SCAN ALL TRACKED WALLETS FOR WHALE TRADES
        async function scanWhaleTrades() {
            if (state.isScanning) return;
            
            state.isScanning = true;
            const btn = document.getElementById('btn-scan');
            const icon = document.getElementById('scan-icon');
            
            btn.disabled = true;
            icon.classList.add('animate-spin');
            showApiStatus('üîç Scanning tracked wallets on Hyperliquid...', 'info');

            try {
                const allTrades = [];
                const minAmount = parseInt(document.getElementById('min-amount').value);
                const activeAsset = document.getElementById('asset-select').value;
                
                // Scan each tracked wallet
                let scannedCount = 0;
                for (const walletAddress of state.trackedWallets) {
                    scannedCount++;
                    showApiStatus(`üîç Scanning wallet ${scannedCount}/${state.trackedWallets.size}...`, 'info');
                    
                    const fills = await getUserFills(walletAddress);
                    
                    if (fills && fills.length > 0) {
                        // Filter and process fills
                        const filteredFills = fills
                            .filter(fill => {
                                const tradeValue = parseFloat(fill.sz) * parseFloat(fill.px);
                                
                                // Filter by minimum amount
                                if (tradeValue < minAmount) return false;
                                
                                // Filter by asset
                                if (activeAsset !== 'all' && fill.coin !== activeAsset) return false;
                                
                                // Only recent trades (last 24 hours)
                                const hoursAgo = (Date.now() - fill.time) / (1000 * 60 * 60);
                                if (hoursAgo > 24) return false;
                                
                                return true;
                            })
                            .map(fill => ({
                                ...fill,
                                walletAddress,
                                value: parseFloat(fill.sz) * parseFloat(fill.px)
                            }));
                        
                        allTrades.push(...filteredFills);
                    }
                    
                    // Small delay to avoid rate limiting
                    await new Promise(resolve => setTimeout(resolve, 200));
                }

                // Sort by time (most recent first)
                allTrades.sort((a, b) => b.time - a.time);
                state.trades = allTrades;

                updateTradesTable();
                updateActivityFeed();
                updateStats();

                if (allTrades.length > 0) {
                    showApiStatus(`‚úÖ Found ${allTrades.length} whale trades from ${state.trackedWallets.size} wallets!`, 'success');
                } else {
                    showApiStatus('‚ö†Ô∏è No whale trades found. Try lowering the minimum or adding more wallets!', 'info');
                }

            } catch (error) {
                console.error('Scan error:', error);
                showApiStatus('‚ùå Error scanning: ' + error.message, 'error');
            } finally {
                state.isScanning = false;
                btn.disabled = false;
                icon.classList.remove('animate-spin');
            }
        }

        // UPDATE TRADES TABLE
        function updateTradesTable() {
            const tbody = document.getElementById('trades-tbody');
            const countEl = document.getElementById('trades-count');
            
            countEl.textContent = state.trades.length;

            if (state.trades.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="8" class="px-4 py-8 text-center text-gray-400">
                            <i class="fas fa-search mb-2 text-2xl"></i>
                            <p>No whale trades found. Try scanning or adjusting filters!</p>
                        </td>
                    </tr>
                `;
                return;
            }

            tbody.innerHTML = state.trades.map(trade => {
                const isBuy = trade.side === 'B';
                const sizeLabel = trade.value >= 1000000 ? 'üê≥ MEGA' :
                                 trade.value >= 500000 ? 'üêã HUGE' :
                                 trade.value >= 100000 ? 'ü¶à LARGE' : 'üêü';
                
                return `
                    <tr class="animate-fade-in">
                        <td class="px-4 py-3">
                            <div class="font-mono text-xs">${shortenAddress(trade.walletAddress)}</div>
                            <div class="text-xs text-gray-400 mt-1">
                                <span class="badge-whale px-2 py-0.5 rounded text-xs">${sizeLabel}</span>
                            </div>
                        </td>
                        <td class="px-4 py-3">
                            <div class="font-semibold text-lg">${trade.coin}</div>
                        </td>
                        <td class="px-4 py-3">
                            <span class="${isBuy ? 'badge-buy' : 'badge-sell'} px-3 py-1 rounded font-semibold">
                                ${isBuy ? 'üìà BUY' : 'üìâ SELL'}
                            </span>
                        </td>
                        <td class="px-4 py-3 font-medium">
                            ${parseFloat(trade.sz).toFixed(4)}
                        </td>
                        <td class="px-4 py-3">
                            $${parseFloat(trade.px).toLocaleString()}
                        </td>
                        <td class="px-4 py-3 font-semibold text-white">
                            ${formatAmount(trade.value)}
                        </td>
                        <td class="px-4 py-3 text-sm text-gray-400">
                            ${formatTime(trade.time)}
                        </td>
                        <td class="px-4 py-3">
                            <div class="flex gap-2">
                                <button onclick="copyToClipboard('${trade.walletAddress}')" class="p-2 bg-blue-600 hover:bg-blue-700 rounded-lg transition" title="Copy Address">
                                    <i class="fas fa-copy text-xs"></i>
                                </button>
                                <button onclick="window.open('https://app.hyperliquid.xyz/explorer/address/${trade.walletAddress}', '_blank')" class="p-2 bg-purple-600 hover:bg-purple-700 rounded-lg transition" title="View on Explorer">
                                    <i class="fas fa-external-link-alt text-xs"></i>
                                </button>
                            </div>
                        </td>
                    </tr>
                `;
            }).join('');
        }

        // UPDATE ACTIVITY FEED
        function updateActivityFeed() {
            const feed = document.getElementById('activity-feed');
            
            if (state.trades.length === 0) {
                feed.innerHTML = '<div class="text-sm p-2 rounded-lg bg-slate-800/30 text-center text-gray-400">No activity yet</div>';
                return;
            }
            
            feed.innerHTML = state.trades.slice(0, 10).map(trade => {
                const isBuy = trade.side === 'B';
                return `
                    <div class="text-sm p-2 rounded-lg bg-slate-800/30 animate-fade-in">
                        <div class="flex items-start gap-2">
                            <span class="text-lg">${isBuy ? 'üìà' : 'üìâ'}</span>
                            <div class="flex-1">
                                <div class="font-medium">${trade.coin}</div>
                                <div class="text-gray-400 text-xs">${shortenAddress(trade.walletAddress)}</div>
                                <div class="flex gap-1 mt-1">
                                    <span class="text-xs ${isBuy ? 'text-green-400' : 'text-red-400'}">
                                        ${isBuy ? 'BUY' : 'SELL'}
                                    </span>
                                    <span class="text-xs text-gray-400">‚Ä¢</span>
                                    <span class="text-xs font-semibold">${formatAmount(trade.value)}</span>
                                </div>
                            </div>
                            <div class="text-gray-500 text-xs">${formatTime(trade.time)}</div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // UPDATE STATS
        function updateStats() {
            document.getElementById('stat-trades').textContent = state.trades.length;
            document.getElementById('stat-wallets').textContent = state.trackedWallets.size;
            
            const totalVolume = state.trades.reduce((sum, trade) => sum + trade.value, 0);
            document.getElementById('stat-volume').textContent = formatAmount(totalVolume);
            
            const avgTrade = state.trades.length > 0 ? totalVolume / state.trades.length : 0;
            document.getElementById('stat-avg').textContent = formatAmount(avgTrade);
        }

        // UPDATE WALLETS LIST
        function updateWalletsList() {
            const list = document.getElementById('wallets-list');
            
            if (state.trackedWallets.size === 0) {
                list.innerHTML = `
                    <p class="text-gray-400 text-center py-8">
                        <i class="fas fa-fish mb-2 text-2xl block"></i>
                        No wallets tracked yet. Add some whales to watch!
                    </p>
                `;
                return;
            }

            list.innerHTML = Array.from(state.trackedWallets).map(address => `
                <div class="glass-card p-3 rounded-lg flex items-center justify-between">
                    <div class="flex-1">
                        <div class="font-mono text-sm">${address}</div>
                        <div class="text-xs text-gray-400 mt-1">Hyperliquid Wallet</div>
                    </div>
                    <button onclick="removeWallet('${address}')" class="text-red-400 hover:text-red-300 ml-2">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            `).join('');
        }

        // ADD WALLET
        function addWallet() {
            const input = document.getElementById('custom-wallet');
            const address = input.value.trim();
            
            if (!address || !address.startsWith('0x') || address.length !== 42) {
                showApiStatus('‚ùå Invalid address format. Must be 42 characters starting with 0x', 'error');
                return;
            }
            
            if (state.trackedWallets.has(address)) {
                showApiStatus('‚ö†Ô∏è Wallet already tracked!', 'info');
                return;
            }
            
            state.trackedWallets.add(address);
            localStorage.setItem('hl_tracked_wallets', JSON.stringify([...state.trackedWallets]));
            
            updateWalletsList();
            updateStats();
            input.value = '';
            
            showApiStatus('‚úÖ Wallet added! Scan to see their trades.', 'success');
        }

        // REMOVE WALLET
        function removeWallet(address) {
            state.trackedWallets.delete(address);
            localStorage.setItem('hl_tracked_wallets', JSON.stringify([...state.trackedWallets]));
            
            updateWalletsList();
            updateStats();
            
            showApiStatus('‚úÖ Wallet removed from tracking', 'success');
        }

        // COPY TO CLIPBOARD
        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                showApiStatus('‚úÖ Address copied!', 'success');
            });
        }

        // EXPORT DATA
        function exportData() {
            const data = {
                trades: state.trades,
                trackedWallets: Array.from(state.trackedWallets),
                exportDate: new Date().toISOString()
            };
            
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `hyperliquid-whale-data-${Date.now()}.json`;
            a.click();
            URL.revokeObjectURL(url);
            
            showApiStatus('‚úÖ Data exported!', 'success');
        }

        // INIT APP
        function initApp() {
            // Event listeners
            document.getElementById('btn-scan').addEventListener('click', scanWhaleTrades);
            document.getElementById('btn-refresh').addEventListener('click', scanWhaleTrades);
            document.getElementById('btn-add-wallet').addEventListener('click', addWallet);
            document.getElementById('btn-export').addEventListener('click', exportData);
            
            // Custom wallet on Enter
            document.getElementById('custom-wallet').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') addWallet();
            });
            
            // Tab switching
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    const tab = btn.getAttribute('data-tab');
                    document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('tab-active'));
                    document.querySelectorAll('.tab-content').forEach(content => content.classList.add('hidden'));
                    btn.classList.add('tab-active');
                    document.getElementById(`${tab}-tab`).classList.remove('hidden');
                });
            });
            
            // Init UI
            updateWalletsList();
            updateStats();
            
            showApiStatus('üêã Ready! Click "Scan Whales" to fetch LIVE data from Hyperliquid', 'success');
        }

        document.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>
