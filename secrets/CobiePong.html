<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>Pong Prototype</title>
<style>
    body {
        margin: 0;
        background: black;
        color: white;
        font-family: Arial, sans-serif;
        overflow: hidden;
    }

    #gameCanvas {
        display: block;
        margin: 0 auto;
        background: #111;
    }

    /* Menü-Overlay */
    #menu {
        position: absolute;
        top: 0; left: 0; right: 0; bottom: 0;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        background: rgba(0,0,0,0.85);
        text-align: center;
    }

    .menu-option {
        font-size: 32px;
        padding: 10px 0;
        cursor: pointer;
    }

    .menu-option.selected {
        color: yellow;
    }
</style>
</head>
<body>

<canvas id="gameCanvas" width="800" height="500"></canvas>

<div id="menu">
    <h1>PONG</h1>
    <div class="menu-option selected">Player vs CPU</div>
    <div class="menu-option">Player1 vs Player2</div>
    <p>Mit ↑ ↓ auswählen – ENTER starten</p>
</div>

<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");

let gameMode = 0; // 0 = PvsCPU, 1 = PvP
let menuIndex = 0;
const menuOptions = document.querySelectorAll(".menu-option");
const menu = document.getElementById("menu");

// Spieler-Objekte
const paddleWidth = 10;
const paddleHeight = 80;

let p1 = { x: 20, y: canvas.height/2 - 40 };
let p2 = { x: canvas.width - 30, y: canvas.height/2 - 40 };

let ball = { x: canvas.width/2, y: canvas.height/2, vx: 5, vy: 5 };

// Eingaben
let keys = {};

// Menü-Steuerung
document.addEventListener("keydown", (e) => {
    if (menu.style.display !== "none") {
        if (e.key === "ArrowUp" || e.key === "ArrowDown") {
            menuIndex = menuIndex === 0 ? 1 : 0;
            updateMenuVisual();
        }
        if (e.key === "Enter") {
            gameMode = menuIndex;
            menu.style.display = "none";
        }
    }
    keys[e.key] = true;
});

document.addEventListener("keyup", (e) => keys[e.key] = false);

function updateMenuVisual() {
    menuOptions.forEach((opt, i) => {
        opt.classList.toggle("selected", i === menuIndex);
    });
}

function update() {
    // Player 1
    if (keys["w"]) p1.y -= 6;
    if (keys["s"]) p1.y += 6;

    // Player 2
    if (gameMode === 1) {
        // Mensch
        if (keys["ArrowUp"]) p2.y -= 6;
        if (keys["ArrowDown"]) p2.y += 6;
    } else {
        // CPU verfolgt den Ball
        if (ball.y < p2.y + paddleHeight/2) p2.y -= 4;
        if (ball.y > p2.y + paddleHeight/2) p2.y += 4;
    }

    // Begrenzungen
    p1.y = Math.max(0, Math.min(canvas.height - paddleHeight, p1.y));
    p2.y = Math.max(0, Math.min(canvas.height - paddleHeight, p2.y));

    // Ballbewegung
    ball.x += ball.vx;
    ball.y += ball.vy;

    // Oben/Unten Wand-Kollision
    if (ball.y <= 0 || ball.y >= canvas.height) ball.vy *= -1;

    // Paddle-Kollisionen
    if (ball.x <= p1.x + paddleWidth &&
        ball.y >= p1.y &&
        ball.y <= p1.y + paddleHeight) {
        ball.vx *= -1;
    }
    if (ball.x >= p2.x - paddleWidth &&
        ball.y >= p2.y &&
        ball.y <= p2.y + paddleHeight) {
        ball.vx *= -1;
    }

    // Reset bei Punkt
    if (ball.x < 0 || ball.x > canvas.width) {
        ball.x = canvas.width/2;
        ball.y = canvas.height/2;
    }
}

function draw() {
    ctx.clearRect(0,0,canvas.width,canvas.height);

    // Mittellinie
    ctx.strokeStyle = "white";
    ctx.setLineDash([5, 5]);
    ctx.beginPath();
    ctx.moveTo(canvas.width/2, 0);
    ctx.lineTo(canvas.width/2, canvas.height);
    ctx.stroke();

    ctx.setLineDash([]);

    // Paddles
    ctx.fillStyle = "white";
    ctx.fillRect(p1.x, p1.y, paddleWidth, paddleHeight);
    ctx.fillRect(p2.x, p2.y, paddleWidth, paddleHeight);

    // Ball
    ctx.beginPath();
    ctx.arc(ball.x, ball.y, 10, 0, Math.PI*2);
    ctx.fill();
}

function loop() {
    if (menu.style.display === "none") update();
    draw();
    requestAnimationFrame(loop);
}

loop();
</script>

</body>
</html>
